from collections import defaultdict

merged = [{'bm25_norm': 1.0, 'bm25_score': 1.659479539985674, 'chunk_index': 1, 'combined': 1.0, 'doc_id': 970, 'document_id': 970, 'document_name': 'CG_RM_2024_mom.pdf', 'id': '970:1', 'meeting_id': 101, 'rank_score': -4.538426876068115, 'text': 'Strategic Initiatives: The planned Governance Automation Portal, ESG framework rollout, and risk automation tools underscore a strategic direction towards digitalization and AI adoption. These challenges present significant opportunities for AI to transform our GRC functions from reactive to proactive and predictive. 3. PROPOSED AI SOLUTIONS FOR GRC We propose implementing AI-powered solutions across key GRC domains: AI-Powered Reporting   Analytics Automation: Automate the generation and standardization of governance and risk reports using Natural Language Generation  NLG  and data aggregation tools. Enable AI-driven insights and anomaly detection within quarterly performance and risk reports. Integrate threat intelligence and vulnerability metrics into automated monthly dashboards. Intelligent Risk Assessment   Predictive Analytics: Revise the risk scoring model with AI to incorporate scenario-based impact analysis and predictive capabilities. Utilize AI to identify emerging risks by analyzing external data feeds  market trends, regulatory changes, news . Automate reminders and track progress for risk-owner updates, enhancing accountability. Enhanced Cybersecurity Threat Detection   Response: Deploy AI for real-time threat detection, anomaly analysis, and automated response to cyber incidents. Enhance vulnerability assessment and patching prioritization using AI. Automate the completion of MFA rollout and monitor its effectiveness. Automated Compliance Monitoring   Audit Support: Implement AI to automate control testing and evidence collection, improving timeliness. Facilitate AI-driven self-certification processes for compliance across units. Assist in identifying recurring gaps through AI-powered pattern recognition in audit findings.', 'vec_norm': 1.0, 'vec_score': 0.6645992, 'weighted_score': 0.0}, {'bm25_norm': 0.9736243895203315, 'bm25_score': 1.6233689555212094, 'chunk_index': 2, 'combined': 0.8727941160469987, 'doc_id': 970, 'document_id': 970, 'document_name': 'CG_RM_2024_mom.pdf', 'id': '970:2', 'meeting_id': 101, 'rank_score': -0.4777330458164215, 'text': 'AI-Driven Governance Workflow   Decision Support: Develop a Governance Automation Portal powered by AI to streamline workflows, document management, and stakeholder communication. Support ESG framework rollout with AI for data collection, analysis, and reporting. Centralize governance data repositories for enhanced cross- functional visibility and AI-driven insights. 4. BENEFITS OF AI INTEGRATION Adopting AI in GRC will yield substantial benefits: Increased Efficiency: Automating repetitive tasks frees up human resources for strategic activities. Enhanced Risk Management: Proactive identification and mitigation of risks through predictive analytics and real-time monitoring. Improved Decision-Making: Data-driven insights and transparent reporting empower better strategic choices. Strengthened Compliance: Continuous monitoring and automated checks ensure adherence to regulations. Reduced Costs: Streamlined processes and reduced manual effort can lead to significant cost savings. Proactive Posture: Shifting from reactive problem-solving to proactive risk prevention and opportunity identification. Enhanced Cybersecurity: Faster detection and response to threats minimize potential damage. 5. IMPLEMENTATION ROADMAP   CONSIDERATIONS We propose a phased implementation approach, prioritizing initiatives with the highest impact and feasibility: Phase 1  Q1 2025 : Foundational Automation   Reporting Enhancement Develop and deploy standardized reporting templates  Secretariat  All Units . Initiate AI-driven risk scoring model revision  Risk Management . 1.', 'vec_norm': 0.7215487058369997, 'vec_score': 0.6288594, 'weighted_score': 0.0}, {'bm25_norm': 0.49056228034487565, 'bm25_score': 0.9620134540662162, 'chunk_index': 3, 'combined': 0.6136109724425252, 'doc_id': 970, 'document_id': 970, 'document_name': 'CG_RM_2024_mom.pdf', 'id': '970:3', 'meeting_id': 101, 'rank_score': -6.737943649291992, 'text': 'Roll out automated reminders for risk-owner updates  Risk Management . Begin integration of vulnerability metrics into dashboards  IT Security . Phase 2  Q2-Q3 2025 : Advanced Analytics   Workflow Automation Begin development of the Governance Automation Portal  PMO . Implement AI for control effectiveness monitoring and self- certification  Compliance Internal Audit . Enhance cybersecurity threat intelligence and response automation  Cybersecurity . Initiate AI for data classification and privacy impact assessments  DPO . Phase 3  Q4 2025   Beyond : Full Integration   Strategic AI Initiatives Complete Governance Automation Portal deployment. Roll out ESG governance framework with AI support. Implement unified audit evidence management system. Leverage AI for advanced predictive risk analytics and strategic forecasting. Budget allocation for risk automation and analytics tool   42 lakhs  will be crucial for this phase. Key Considerations: Data Strategy: Ensuring data quality, accessibility, and integration. Technology Stack: Selecting appropriate AI platforms and tools. Change Management: Training, communication, and stakeholder buy-in are critical for successful adoption. Talent   Expertise: Upskilling existing teams or acquiring specialized AI  data science talent. Security   Ethics: Adhering to data privacy, security, and ethical AI principles. 6. CONCLUSION The strategic integration of AI into our Corporate Governance and Risk Management functions is not merely an upgrade but a necessary evolution to navigate the complexities of the modern business environment. By embracing these AI-driven solutions, we will build a more robust, agile, and secure organization, better equipped to identify opportunities, mitigate risks, and achieve     2. 3.', 'vec_norm': 0.7981840105889996, 'vec_score': 0.6386957, 'weighted_score': 0.0}, {'bm25_norm': 0.29465323267948185, 'bm25_score': 0.6937963366452833, 'chunk_index': 0, 'combined': 0.3920842679667098, 'doc_id': 970, 'document_id': 970, 'document_name': 'CG_RM_2024_mom.pdf', 'id': '970:0', 'meeting_id': 101, 'rank_score': -9.554004669189453, 'text': 'PROPOSAL FOR LEVERAGING AI IN DIGITAL CORPORATE GOVERNANCE   RISK MANAGEMENT 1. EXECUTIVE SUMMARY This proposal outlines a strategic initiative to integrate Artificial Intelligence  AI  into our digital Corporate Governance and Risk Management  GRC  framework. As highlighted in the recent Annual Governance   Risk Review Meeting  November 18, 2025 , the evolving regulatory landscape, increasing cyber threats, and the need for greater operational efficiency demand proactive and intelligent solutions. By adopting AI-driven technologies, we can significantly enhance risk identification, improve compliance automation, strengthen cybersecurity, streamline reporting, and support more informed strategic decision-making, thereby fostering a more resilient and agile corporate environment. 2. CURRENT CHALLENGES AND OPPORTUNITIES The Annual Governance   Risk Review Meeting identified several critical areas requiring enhanced focus and improved methodologies: Inconsistent Reporting   Manual Processes: Delays in policy updates, evidence logs, and the need to standardize governance reporting templates point to inefficiencies in current manual workflows. Risk Visibility   Accountability: Gaps exist in tracking action items and refining risk-owner accountability mechanisms, necessitating better oversight and automated support. Cybersecurity Posture: Persistent cyber threats, vendor reliability risks, and the need for advanced threat intelligence require a more dynamic and predictive defense strategy. Audit   Control Effectiveness: Recurring gaps in documentation, evidence collection timeliness, and the need for efficient control monitoring  e.g., quarterly self-certifications  indicate opportunities for automation. Data Management   Compliance: Ensuring readiness for new regulations  e.g., DPDP Act  and managing diverse data sources for governance requires intelligent data handling.', 'vec_norm': 0.5382308208975517, 'vec_score': 0.60533017, 'weighted_score': 0.0}]

group_by = ['meeting_id','doc_id']

grouped_chunks = defaultdict(list)

for chunk in merged:
    # Create composite key based on group_by fields
    key_parts = []
    group_info = {}

    for field in group_by:
        value = chunk.get(field)
        if value is not None:
            key_parts.append(f"{field}={value}")
            group_info[field] = value
        else:
            key_parts.append(f"{field}=unknown")
            group_info[field] = "unknown"

    # Create a tuple key for grouping
    group_key = tuple(group_info.items())
    grouped_chunks[group_key].append(chunk)
